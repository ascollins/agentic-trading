<div class="card-label">PORTFOLIO</div>
{% if portfolio %}
  <div style="display:flex; align-items:baseline; gap:8px; margin:4px 0 6px;">
    <span style="font-size:1.5rem; font-weight:700; font-family:'JetBrains Mono',monospace; color:var(--text-primary);">
      ${{ "{:,.0f}".format(portfolio.equity) }}
    </span>
    <span style="font-size:9px; color:var(--text-muted); text-transform:uppercase;">EQUITY</span>
  </div>

  <!-- Period tabs -->
  <div style="display:flex; gap:3px; margin-bottom:6px;" id="pnl-tabs">
    <button onclick="switchPnlTab('today')" id="tab-today"
            style="font-size:9px; padding:1px 8px; border-radius:3px; border:1px solid var(--color-positive); background:var(--color-positive); color:#000; cursor:pointer; font-weight:600; font-family:'JetBrains Mono',monospace;">
      TODAY
    </button>
    <button onclick="switchPnlTab('7d')" id="tab-7d"
            style="font-size:9px; padding:1px 8px; border-radius:3px; border:1px solid var(--border-card); background:transparent; color:var(--text-muted); cursor:pointer; font-family:'JetBrains Mono',monospace;">
      7D
    </button>
    <button onclick="switchPnlTab('30d')" id="tab-30d"
            style="font-size:9px; padding:1px 8px; border-radius:3px; border:1px solid var(--border-card); background:transparent; color:var(--text-muted); cursor:pointer; font-family:'JetBrains Mono',monospace;">
      30D
    </button>
  </div>

  <div id="pnl-panel-today">
    <span class="portfolio-pnl {{ 'positive' if portfolio.pnl_positive else 'negative' }}" style="font-size:13px;">
      {{ "+" if portfolio.pnl_positive else "" }}{{ "{:,.2f}".format(portfolio.pnl_today) }}
      ({{ "+" if portfolio.pnl_positive else "" }}{{ "%.2f" | format(portfolio.pnl_today_pct) }}%)
    </span>
  </div>

  <div id="pnl-panel-7d" style="display:none;">
    <span class="portfolio-pnl {{ 'positive' if portfolio.pnl_7d_positive else 'negative' }}" style="font-size:13px;">
      {{ "+" if portfolio.pnl_7d_positive else "" }}{{ "{:,.2f}".format(portfolio.pnl_7d) }}
      ({{ "+" if portfolio.pnl_7d_positive else "" }}{{ "%.2f" | format(portfolio.pnl_7d_pct) }}%)
    </span>
  </div>

  <div id="pnl-panel-30d" style="display:none;">
    <span class="portfolio-pnl {{ 'positive' if portfolio.pnl_30d_positive else 'negative' }}" style="font-size:13px;">
      {{ "+" if portfolio.pnl_30d_positive else "" }}{{ "{:,.2f}".format(portfolio.pnl_30d) }}
      ({{ "+" if portfolio.pnl_30d_positive else "" }}{{ "%.2f" | format(portfolio.pnl_30d_pct) }}%)
    </span>
  </div>

  <div style="margin-top:4px; font-size:9px; color:var(--text-muted); text-transform:uppercase;">
    {{ portfolio.open_positions }} OPEN POSITION{{ "S" if portfolio.open_positions != 1 else "" }}
  </div>

{% else %}
  <div class="empty-state" style="padding:8px 0;">
    <div class="empty-message">NO PORTFOLIO DATA</div>
    <div class="empty-detail">Connect to an exchange or start paper trading</div>
  </div>
{% endif %}

<script>
  function switchPnlTab(period) {
    ['today', '7d', '30d'].forEach(function(p) {
      var panel = document.getElementById('pnl-panel-' + p);
      var tab = document.getElementById('tab-' + p);
      if (panel) panel.style.display = (p === period) ? '' : 'none';
      if (tab) {
        if (p === period) {
          tab.style.background = 'var(--color-positive)';
          tab.style.color = '#000';
          tab.style.borderColor = 'var(--color-positive)';
          tab.style.fontWeight = '600';
        } else {
          tab.style.background = 'transparent';
          tab.style.color = 'var(--text-muted)';
          tab.style.borderColor = 'var(--border-card)';
          tab.style.fontWeight = 'normal';
        }
      }
    });
  }
</script>
